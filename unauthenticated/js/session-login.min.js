try{const e=document.querySelector("html"),t="data-platform";if(navigator.userAgentData&&navigator.userAgentData.platform){const n=navigator.userAgentData.platform.toLowerCase();if(n.includes("linux")){e.setAttribute(t,"linux")}else if(n.includes("windows")){e.setAttribute(t,"windows")}else if(n.includes("mac")){e.setAttribute(t,"macos")}}else if(navigator.platform){const n=navigator.platform.toLowerCase();if(n.includes("linux")){e.setAttribute(t,"linux")}else if(n.includes("win")){e.setAttribute(t,"windows")}else if(n.includes("mac")){e.setAttribute(t,"macos")}}}catch(e){console.warn("Failed to detect platform:",e)}document.addEventListener("DOMContentLoaded",function(e){(function(){const e=document.querySelectorAll('input[type="password"]');e.forEach(e=>{const t=document.createElement("span");t.classList.add("input_warning_caps");t.setAttribute("title","Caps Lock");t.classList.add("large");e.classList.add("use_input_warning_caps");e.parentNode.insertBefore(t,e.nextSibling);e.addEventListener("blur",function(){this.nextSibling.classList.remove("visible")});e.addEventListener("keydown",function(e){if(typeof e.getModifierState==="function"){let t;if(e.keyCode===20){t=!e.getModifierState("CapsLock")}else{t=e.getModifierState("CapsLock")}if(t){this.nextSibling.classList.add("visible")}else{this.nextSibling.classList.remove("visible")}}})})})();(function(){const e=typeof theme_language==="object"?theme_language:{},t=document.querySelector(".session_login_back .form-signin-group > .btn-success"),n=document.querySelectorAll(".session_login_flipper [data-flipper]"),s=document.querySelector('.session_login_back input[name="forgot"]'),r=document.querySelector(".session_login_back [data-unlocker]"),i=document.querySelector('.session_login_back input[name="newpass"]'),o=document.querySelector('.session_login_back input[name="newpass2"]'),a=".container.session_login",c=function(e){let t=e.querySelector(".panel-body > [data-fatal-error-text]");if(!t||!t.textContent.trim()){t=e.querySelector(".panel-body > .err-content")}return t},l=function(t,n){let s=document.querySelector(a+" > .alert");if(!s){s=document.createElement("div");s.className="alert";s.innerHTML=`\n                        <strong><i class="fa"></i> </strong><br>\n                        <span></span>`;const e=document.querySelector(a);if(e){e.insertBefore(s,e.firstChild)}}s.classList.remove("alert-warning","alert-success","alert-danger");const r=s.querySelector(".fa"),i=s.querySelector("strong"),o=s.querySelector("span");if(t==="success"){const t="faa-bounce animated".split(" ");s.classList.add("alert-success",...t);setTimeout(()=>{s.classList.remove(...t)},1500);if(r)r.className="fa fa-check-circle";if(i)i.innerHTML='<i class="fa fa-check-circle"></i> '+e.session_success;if(o)o.innerHTML=n}else{const t="faa-horizontal animated".split(" ");s.classList.add("alert-danger",...t);setTimeout(()=>{s.classList.remove(...t)},1500);if(r)r.className="fa fa-exclamation-circle";if(i)i.innerHTML='<i class="fa fa-exclamation-circle"></i> '+e.session_error;if(o)o.textContent=n}};if(n){n.forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();const t=document.querySelector(".session_login_flipper");t.classList.toggle("flipped");const n=!t.classList.contains("flipped")?document.querySelector('input[name="user"]'):document.querySelector('input[name="forgot"]');if(n){setTimeout(()=>{n.focus()},600)}})})}if(s){s.addEventListener("keydown",function(e){if(e.key==="Enter"){e.preventDefault();if(t)t.click();return false}})}if(i){i.addEventListener("keydown",function(e){if(e.key==="Enter"){e.preventDefault();if(o)o.focus();return false}});if(o){o.addEventListener("keydown",function(e){if(e.key==="Enter"){e.preventDefault();if(r)r.click();return false}})}}if(t){t.addEventListener("click",function(t){t.preventDefault();if(this.classList.contains("disabled")){return}if(!s||!s.value.trim()){l("error",e.session_cannot);return}const n=s.value.trim(),r=this.querySelector("i");spinner(r);fetch("forgot_send.cgi",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:`forgot=${encodeURIComponent(n)}`}).then(t=>{if(!t.ok){throw new Error(e.session_neterror)}return t.text()}).then(t=>{const n=new DOMParser,s=n.parseFromString(t,"text/html");const i=s.querySelector(".panel-body > center");if(i&&i.textContent.trim()){spinner(r,true,true);l("success",i.innerHTML.trim());return}spinner(r,true);const o=c(s);if(o&&o.textContent.trim()){l("error",o.textContent.trim());return}l("error",e.session_unkerror)}).catch(t=>{spinner(r,true);console.warn("Request failed:",t);l("error",e.session_conerror)})})}if(r){const t=document.querySelector(".session_login_back"),s=function(){t.remove();const e=new URL(window.location.href);e.search="";history.replaceState({},document.title,e);const n=document.querySelector(a+" .alert");if(n){n.remove()}};if(n.length>0){n[0].addEventListener("click",function(e){e.preventDefault();s()})}if(i){setTimeout(()=>{i.focus()},0)}r.addEventListener("click",function(s){s.preventDefault();if(this.classList.contains("disabled")){return}if(!i||!i.value.length){l("error",e.session_resetepassreq);return}if(!o||!o.value.length){l("error",e.session_pwdconf);return}const r=i.value;const a=o.value;if(r!==a){l("error",e.session_pwdmatch);return}const u=t?t.getAttribute("data-forgot"):null,d=t?t.getAttribute("data-username"):null;if(!u){l("error",e.session_noid);return}const f=this.querySelector("i");spinner(f);fetch("forgot.cgi",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:`id=${encodeURIComponent(u)}&newpass=${encodeURIComponent(r)}&newpass2=${encodeURIComponent(a)}`}).then(t=>{if(!t.ok){throw new Error(e.session_neterror)}return t.text()}).then(t=>{const s=new DOMParser,r=s.parseFromString(t,"text/html");const i=c(r);if(i&&i.textContent.trim()){spinner(f,true);l("error",i.textContent.trim());return}spinner(f,true,true);n[0].click();l("success",e.session_pwdsucc)}).catch(t=>{spinner(f,true);console.warn("Request failed:",t);l("error",e.session_conerror)})})}})()});function spinner(e,t,n){e=e?e:document.querySelector("button i.fa-sign-in:not(.invisible)")||document.querySelector("button i.fa-qrcode:not(.invisible)"),s='<span class="cspinner_container"><span class="cspinner">'+'<span class="cspinner-icon white small"></span></span></span>';if(e&&!t){e.classList.add("invisible");e.insertAdjacentHTML("afterend",s);e.parentNode.classList.add("disabled");e.parentNode.disabled=true}else if(e&&t){e.classList.remove("invisible");e.parentNode.classList.remove("disabled");e.parentNode.disabled=false;var r=document.querySelector(".cspinner_container");if(r){r.parentNode.removeChild(r)}if(n){e.className="fa2 fa2-marker-check";e.parentNode.classList.add("disabled")}}}